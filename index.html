<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Rice → CVG</title>
<style>
  :root{--t:#222;--m:#666;--g:#e8e8e8;--bg:#fafafa}
  *{box-sizing:border-box;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
  body{margin:0;background:var(--bg);color:var(--t);padding:20px}
  .wrap{max-width:760px;margin:0 auto}
  h1{font-size:20px;margin:0 0 8px}
  p.note{font-size:12px;color:var(--m);margin:6px 0 16px}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  @media(max-width:720px){.grid{grid-template-columns:1fr}}
  label{font-size:12px;color:var(--m);display:block;margin-bottom:6px}
  input{width:100%;padding:10px 12px;border:1px solid var(--g);border-radius:10px;background:#fff;font-size:14px}
  .btns{display:flex;gap:8px;margin-top:12px}
  button{border:1px solid var(--g);background:#fff;border-radius:10px;padding:10px 12px;cursor:pointer}
  .cards{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:16px}
  @media(max-width:720px){.cards{grid-template-columns:1fr}}
  .card{background:#fff;border:1px solid var(--g);border-radius:14px;padding:14px}
  .k{font-size:11px;color:var(--m);text-transform:uppercase;letter-spacing:.06em}
  .v{font-size:20px;font-weight:600;margin-top:4px}
  .row{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-top:8px}
  .row2{display:grid;grid-template-columns:1fr 1fr 1fr 1fr;gap:10px;margin-top:8px}
</style>
</head>
<body>
<div class="wrap">
  <h1>Rice Volume & CVG</h1>
  <p class="note">CVG is gross container volume after packing efficiency. Defaults suit uncooked white rice. Adjust as needed.</p>

  <div class="grid">
    <div>
      <label>Number of bags</label>
      <input id="bags" type="number" min="0" step="1" value="10">
    </div>
    <div>
      <label>Size per bag, kg</label>
      <input id="kgPerBag" type="number" min="0" step="0.1" value="5">
    </div>
    <div>
      <label>Bulk density, g/cm³ (typ. 0.80–0.90)</label>
      <input id="rho" type="number" min="0.01" step="0.01" value="0.85">
    </div>
    <div>
      <label>Packing efficiency, %</label>
      <input id="eff" type="number" min="1" max="100" step="1" value="92">
    </div>
  </div>

  <div class="btns">
    <button id="copy">Copy summary</button>
    <button id="reset">Reset</button>
  </div>

  <div class="cards">
    <div class="card">
      <div class="k">Total mass</div>
      <div class="v" id="massKg">–</div>
      <div class="row">
        <div>
          <div class="k">Bags</div>
          <div class="v" id="bagsOut">–</div>
        </div>
        <div>
          <div class="k">kg / bag</div>
          <div class="v" id="kgPerBagOut">–</div>
        </div>
        <div>
          <div class="k">Density</div>
          <div class="v" id="rhoOut">–</div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="k">Loose volume (no packing)</div>
      <div class="v" id="looseMain">–</div>
      <div class="row2">
        <div>
          <div class="k">cm³</div>
          <div class="v" id="looseCm3">–</div>
        </div>
        <div>
          <div class="k">L</div>
          <div class="v" id="looseL">–</div>
        </div>
        <div>
          <div class="k">m³</div>
          <div class="v" id="looseM3">–</div>
        </div>
        <div>
          <div class="k">ft³</div>
          <div class="v" id="looseFt3">–</div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="k">CVG, Container Volume, Gross</div>
      <div class="v" id="cvgMain">–</div>
      <div class="row2">
        <div>
          <div class="k">cm³</div>
          <div class="v" id="cvgCm3">–</div>
        </div>
        <div>
          <div class="k">L</div>
          <div class="v" id="cvgL">–</div>
        </div>
        <div>
          <div class="k">m³</div>
          <div class="v" id="cvgM3">–</div>
        </div>
        <div>
          <div class="k">ft³</div>
          <div class="v" id="cvgFt3">–</div>
        </div>
      </div>
    </div>
  </div>

  <p class="note">Formulae: mass kg = bags × kg/bag; loose cm³ = (mass kg × 1000) ÷ density; CVG cm³ = loose ÷ (packing% ÷ 100).</p>
</div>

<script>
(function () {
  "use strict";

  function $(id) { return document.getElementById(id); }
  function num(v) {
    v = (v == null ? "" : String(v)).trim();
    var n = parseFloat(v);
    return isNaN(n) ? 0 : n;
  }
  function fmt(n) {
    if (!isFinite(n)) return "–";
    if (Math.abs(n) >= 1000000 || Math.abs(n) < 0.001) return n.toExponential(3);
    return n.toLocaleString(undefined, { maximumFractionDigits: 3 });
  }

  function compute() {
    var bags = num($("bags").value);
    var kgPerBag = num($("kgPerBag").value);
    var rho = num($("rho").value);          // g/cm^3
    var eff = num($("eff").value);
    if (eff <= 0 || eff > 100) eff = 100;

    var massKg = bags * kgPerBag;

    // Loose volume (no packing allowance)
    var loose_cm3 = rho > 0 ? (massKg * 1000) / rho : 0;
    var loose_L   = loose_cm3 / 1000;
    var loose_m3  = loose_cm3 / 1000000;
    var loose_ft3 = loose_m3 * 35.3146667;

    // CVG (gross container volume) with packing efficiency
    var cvg_cm3 = loose_cm3 / (eff / 100);
    var cvg_L   = cvg_cm3 / 1000;
    var cvg_m3  = cvg_cm3 / 1000000;
    var cvg_ft3 = cvg_m3 * 35.3146667;

    // Render
    $("massKg").textContent = fmt(massKg) + " kg";
    $("bagsOut").textContent = fmt(bags);
    $("kgPerBagOut").textContent = fmt(kgPerBag);
    $("rhoOut").textContent = rho ? rho.toFixed(2) : "–";

    $("looseMain").textContent  = fmt(loose_cm3) + " cm³";
    $("looseCm3").textContent   = fmt(loose_cm3);
    $("looseL").textContent     = fmt(loose_L);
    $("looseM3").textContent    = fmt(loose_m3);
    $("looseFt3").textContent   = fmt(loose_ft3);

    $("cvgMain").textContent    = fmt(cvg_cm3) + " cm³";
    $("cvgCm3").textContent     = fmt(cvg_cm3);
    $("cvgL").textContent       = fmt(cvg_L);
    $("cvgM3").textContent      = fmt(cvg_m3);
    $("cvgFt3").textContent     = fmt(cvg_ft3);

    // For the Copy Summary button
    window._last = {
      bags: bags, kgPerBag: kgPerBag, rho: rho, eff: eff, massKg: massKg,
      loose_cm3: loose_cm3, loose_L: loose_L, loose_m3: loose_m3, loose_ft3: loose_ft3,
      cvg_cm3: cvg_cm3, cvg_L: cvg_L, cvg_m3: cvg_m3, cvg_ft3: cvg_ft3
    };
  }

  function init() {
    ["bags","kgPerBag","rho","eff"].forEach(function(id){
      $(id).addEventListener("input", compute);
      $(id).addEventListener("change", compute);
      $(id).addEventListener("keyup", compute);
    });

    $("reset").addEventListener("click", function(){
      $("bags").value = 10;
      $("kgPerBag").value = 5;
      $("rho").value = 0.85;
      $("eff").value = 92;
      compute();
    });

    $("copy").addEventListener("click", function(){
      var d = window._last || {};
      var lines = [
        "Bags: " + d.bags + ", kg/bag: " + d.kgPerBag + ", density: " + d.rho + " g/cm^3, packing: " + d.eff + "%", 
        "Mass: " + fmt(d.massKg) + " kg",
        "Loose volume: " + fmt(d.loose_cm3) + " cm^3 | " + fmt(d.loose_L) + " L | " + fmt(d.loose_m3) + " m^3 | " + fmt(d.loose_ft3) + " ft^3",
        "CVG: " + fmt(d.cvg_cm3) + " cm^3 | " + fmt(d.cvg_L) + " L | " + fmt(d.cvg_m3) + " m^3 | " + fmt(d.cvg_ft3) + " ft^3"
      ].join("\n");
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(lines);
      } else {
        // Fallback
        var ta = document.createElement("textarea");
        ta.value = lines;
        document.body.appendChild(ta);
        ta.select();
        try { document.execCommand("copy"); } catch(e) {}
        document.body.removeChild(ta);
      }
    });

    compute(); // initial render
  }

  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", init);
  } else {
    init();
  }
})();
</script>
</body>
</html>
